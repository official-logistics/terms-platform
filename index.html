<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î - K2PS</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
* { margin:0; padding:0; box-sizing:border-box; }
:root {
  --navy:#1a3a6b; --navy2:#2952a3; --blue:#2563eb; --blue2:#1d4ed8;
  --orange:#dd6b20; --red:#c0392b;
  --green:#16a34a;
  --text1:#1a202c; --text2:#4a5568; --muted:#718096;
  --border:#e2e8f0; --bg:#f0f4f8; --card:#fff;
  --note-bg:#fffbeb; --note-border:#f6c94e; --note-text:#744210;
  --bottom-bg:#f7f8fc; --err:#dc2626;
}
body { font-family:"Sarabun",sans-serif; background:var(--bg); color:var(--text1); min-height:100vh; padding:24px 16px 60px; }
.wrap { max-width:480px; margin:0 auto; }

.sec { background:var(--card); border-left:1px solid var(--border); border-right:1px solid var(--border); }
.sec:first-child { border-top:1px solid var(--border); border-radius:16px 16px 0 0; }
.sec-last { border-bottom:1px solid var(--border); border-radius:0 0 16px 16px; }
.sep { border-top:1px solid var(--border); }

/* HEADER */
.header { padding:28px 24px 20px; }
.header h1 { font-size:21px; font-weight:700; color:var(--navy); line-height:1.45; }
.header h1 em { font-style:normal; color:var(--navy2); }
.header .sub { font-size:13px; color:var(--muted); margin-top:8px; line-height:1.6; }

/* FORM SECTION */
.form-sec { padding:20px 24px; display:flex; gap:16px; justify-content:space-between; align-items:flex-start; }
.form-fields { flex:1; display:flex; flex-direction:column; gap:12px; }

.field-group { display:flex; flex-direction:column; gap:4px; }
.field-group label { font-size:12px; font-weight:600; color:var(--navy2); }
.field-group input {
  border:1.5px solid var(--border); border-radius:8px;
  padding:9px 12px; font-family:"Sarabun",sans-serif; font-size:14px;
  color:var(--text1); background:#fff; outline:none;
  transition:border-color 0.15s;
}
.field-group input:focus { border-color:var(--blue); box-shadow:0 0 0 3px rgba(37,99,235,0.1); }
.field-group input.err { border-color:var(--err); }
.field-group .hint { font-size:11px; color:var(--muted); }
.field-group .errmsg { font-size:11px; color:var(--err); display:none; }
.field-group input.err ~ .errmsg { display:block; }

.status-row { font-size:13px; color:var(--text2); margin-top:4px; }
.status-row .badge { color:var(--orange); font-weight:600; }

.qr-block { flex-shrink:0; display:flex; flex-direction:column; align-items:center; gap:6px; }
.qr-block img { width:88px; height:88px; border-radius:6px; border:1px solid var(--border); object-fit:cover; }
.qr-label { font-size:11px; color:var(--muted); text-align:center; }

/* NOTE YELLOW */
.note-yellow { background:var(--note-bg); border-left:4px solid var(--note-border); padding:13px 18px; }
.note-yellow p { font-size:13px; color:var(--note-text); line-height:1.65; }
.note-yellow strong { color:var(--red); font-weight:700; }

/* TERMS */
.terms-sec { padding:18px 24px; }
.terms-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:14px; }
.terms-header h2 { font-size:16px; font-weight:700; color:var(--navy); }
.dots { display:flex; gap:3px; padding:4px; }
.dots span { width:5px; height:5px; background:var(--muted); border-radius:50%; }
.terms-scroll {
  border:1px solid var(--border); border-radius:8px;
  max-height:230px; overflow-y:auto; background:#fafbfc;
  scrollbar-width:thin; scrollbar-color:#cbd5e0 transparent;
}
.terms-scroll::-webkit-scrollbar { width:5px; }
.terms-scroll::-webkit-scrollbar-thumb { background:#cbd5e0; border-radius:3px; }
.term-item { font-size:14px; color:var(--text2); padding:10px 16px; border-bottom:1px solid var(--border); line-height:1.55; }
.term-item:last-child { border-bottom:none; }
.term-item .n { color:var(--navy2); font-weight:700; margin-right:4px; }

/* CHECKBOX */
.cb-row { padding:15px 24px; display:flex; align-items:center; gap:10px; }
.cb-row input { width:18px; height:18px; accent-color:var(--blue); cursor:pointer; flex-shrink:0; }
.cb-row label { font-size:14px; color:var(--text2); cursor:pointer; line-height:1.4; }

/* BUTTON */
.btn-sec { padding:14px 24px 18px; }
#confirmLink {
  display:block; text-decoration:none;
  pointer-events:none; opacity:0.5;
  transition:opacity 0.2s;
}
#confirmLink.active { pointer-events:auto; opacity:1; }
.btn-confirm {
  width:100%; background:var(--blue); color:#fff; border:none;
  border-radius:10px; padding:15px;
  font-family:"Sarabun",sans-serif; font-size:16px; font-weight:600;
  cursor:not-allowed; box-shadow:0 4px 14px rgba(37,99,235,0.3);
  transition:background 0.15s;
}
#confirmLink.active .btn-confirm { cursor:pointer; }
#confirmLink.active .btn-confirm:hover { background:var(--blue2); }

/* BOTTOM */
.bottom-note { background:var(--bottom-bg); padding:14px 20px; }
.bottom-note p { font-size:12px; color:var(--muted); line-height:1.75; }

/* TOAST */
.toast {
  position:fixed; bottom:24px; left:50%; transform:translateX(-50%) translateY(80px);
  background:#1e293b; color:#fff; border-radius:10px; padding:12px 20px;
  font-size:13px; opacity:0; transition:all 0.3s; z-index:999; white-space:nowrap;
}
.toast.show { opacity:1; transform:translateX(-50%) translateY(0); }
.toast.success { background:var(--green); }
.toast.error   { background:var(--err); }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
// ---- Generate QR Code ‡∏à‡∏≤‡∏Å Sheet URL ----
window.addEventListener('load', function() {
  if (typeof QRCode !== 'undefined') {
    new QRCode(document.getElementById('qr-canvas'), {
      text: 'https://script.google.com/macros/s/AKfycbzIz7HPyMttU2fGL8K7lEfAbPYlZU5ilDi2O__3LhngQ_a4MGYjG1j0uZptxtPmelzC7Q/exec',
      width: 88,
      height: 88,
      colorDark: '#1a3a6b',
      colorLight: '#ffffff',
      correctLevel: QRCode.CorrectLevel.M
    });
  }
});
</script>
</head>
<body>
<div class="wrap">

<!-- HEADER -->
<div class="sec header">
  <h1>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞<em>‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î</em> ‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</h1>
  <p class="sub">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</p>
</div>

<!-- FORM SECTION -->
<div class="sec sep form-sec">
  <div class="form-fields">

    <!-- ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• -->
    <div class="field-group">
      <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
      <input type="text" id="inp-name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" oninput="validate()" autocomplete="name">
      <span class="errmsg">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</span>
    </div>

    <!-- ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢ -->
    <div class="field-group">
      <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢ *</label>
      <input type="text" id="inp-code" placeholder="‡πÄ‡∏ä‡πà‡∏ô KPS-00123" oninput="fmtCode(this); validate()" maxlength="10" autocomplete="off">
      <span class="hint">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö KPS-XXXXX (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 5 ‡∏´‡∏•‡∏±‡∏Å)</span>
      <span class="errmsg">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span>
    </div>

    <!-- ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô -->
    <div class="field-group">
      <label>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å (‡∏ö‡∏≤‡∏ó) *</label>
      <input type="text" id="inp-amount" placeholder="‡πÄ‡∏ä‡πà‡∏ô 23000" oninput="fmtAmount(this); validate()" inputmode="numeric">
      <span class="errmsg">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô</span>
    </div>

    <div class="status-row">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ : <span class="badge">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</span></div>
  </div>

  <!-- QR CODE -->
  <div class="qr-block">
    <div id="qr-canvas"></div>
    <div class="qr-label">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</div>
  </div>
</div>

<!-- NOTE YELLOW -->
<div class="note-yellow">
  <p><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</strong> : ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p>
</div>

<!-- TERMS -->
<div class="sec sep terms-sec">
  <div class="terms-header">
    <h2>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î</h2>
    <div class="dots"><span></span><span></span><span></span></div>
  </div>
  <div class="terms-scroll">

    <!-- ‚úèÔ∏è ‡πÅ‡∏Å‡πâ/‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->

    <div class="term-item"><span class="n">1.</span> ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô ‚Äî ‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1-3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div>
    <div class="term-item"><span class="n">2.</span> ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡πÅ‡∏Å‡πà‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏° ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢</div>
    <div class="term-item"><span class="n">3.</span> ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ ‚Äî ‡∏´‡πâ‡∏≤‡∏°‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏ô‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö K2PS ‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô‡∏°‡∏µ‡πÇ‡∏ó‡∏©‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</div>
    <div class="term-item"><span class="n">4.</span> ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ ‚Äî ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏∞‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3-5 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß</div>
    <div class="term-item"><span class="n">5.</span> ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‚Äî ‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å 5% ‡∏Ç‡∏≠‡∏á‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
    <div class="term-item"><span class="n">6.</span> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‚Äî ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô K2PS ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</div>
    <div class="term-item"><span class="n">7.</span> ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô ‚Äî ‡∏´‡∏≤‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏ ‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3 ‡∏ß‡∏±‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö Escrow ‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à</div>
    <div class="term-item"><span class="n">8.</span> ‡∏Ç‡πâ‡∏≠‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö ‚Äî ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ô‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö K2PS ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ñ‡∏≤‡∏ß‡∏£</div>
    <div class="term-item"><span class="n">9.</span> ‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‚Äî K2PS ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏° 3% ‡∏Ç‡∏≠‡∏á‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡∏´‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡πÇ‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢</div>
    <div class="term-item"><span class="n">10.</span> ‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á ‚Äî ‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡∏°‡∏µ‡∏ú‡∏•‡∏ó‡∏≤‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢</div>

    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà:
    <div class="term-item"><span class="n">11.</span> ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
    -->

  </div>
</div>

<!-- CHECKBOX -->
<div class="sec sep cb-row">
  <input type="checkbox" id="agree" onchange="validate()">
  <label for="agree">‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß</label>
</div>

<!-- BUTTON -->
<div class="sec sep btn-sec">
  <a id="confirmLink" href="#" onclick="submitData(event)">
    <button class="btn-confirm" type="button">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠</button>
  </a>
</div>

<!-- BOTTOM NOTE -->
<div class="sec sec-last bottom-note">
  <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏£‡∏∞‡∏ö‡∏ö K2PS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ<br>
  ‡∏£‡∏∞‡∏ö‡∏ö Escrow K2PS ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
</div>

</div><!-- /wrap -->

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
// ================================================================
// üîß ‡πÉ‡∏™‡πà URL ‡∏à‡∏≤‡∏Å Google Apps Script ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡∏î‡∏π‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)
// ================================================================
const SHEET_URL = '';
// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: const SHEET_URL = 'https://script.google.com/macros/s/AKfycbwYyek8i2IV1WBJESMITNwDPb9g-2Z9kAIeVW41EPCx78mTAIBsvJbMtzHfc4av2ix4/exec';

// ---- Validation ----
function validate() {
  const name   = document.getElementById('inp-name').value.trim();
  const code   = document.getElementById('inp-code').value.trim();
  const amount = document.getElementById('inp-amount').value.replace(/,/g,'').trim();
  const agreed = document.getElementById('agree').checked;

  const nameOk   = name.length >= 3;
  const codeOk   = /^KPS-\d{5}$/.test(code);
  const amountOk = /^\d+$/.test(amount) && parseInt(amount) > 0;

  setErr('inp-name',   !nameOk   && name.length > 0);
  setErr('inp-code',   !codeOk   && code.length > 0);
  setErr('inp-amount', !amountOk && amount.length > 0);

  const allOk = nameOk && codeOk && amountOk && agreed;
  const link = document.getElementById('confirmLink');
  link.classList.toggle('active', allOk);
  link.querySelector('button').style.cursor = allOk ? 'pointer' : 'not-allowed';
}

function setErr(id, hasErr) {
  document.getElementById(id).classList.toggle('err', hasErr);
}

// ---- Format: ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢ ‚Üí KPS-XXXXX ----
function fmtCode(el) {
  let v = el.value.toUpperCase().replace(/[^A-Z0-9]/g,'');
  if (v.startsWith('KPS') && v.length > 3) v = 'KPS-' + v.slice(3,8);
  else if (!v.startsWith('KPS') && v.length > 0) v = 'KPS-' + v.slice(0,5);
  el.value = v;
}

// ---- Format: ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô ‚Üí 23,000 ----
function fmtAmount(el) {
  let raw = el.value.replace(/[^0-9]/g,'');
  if (raw) el.value = parseInt(raw).toLocaleString('th-TH');
  else el.value = '';
}


// ---- Submit + redirect ‡πÑ‡∏õ LINE ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ popup) ----
function submitData(e) {
  e.preventDefault();
  const link = document.getElementById('confirmLink');
  if (!link.classList.contains('active')) return;

  const name   = document.getElementById('inp-name').value.trim();
  const code   = document.getElementById('inp-code').value.trim();
  const amount = document.getElementById('inp-amount').value.trim();
  const ts     = new Date().toLocaleString('th-TH', {timeZone:'Asia/Bangkok'});

  if (SHEET_URL) {
    showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...', '');
    fetch(SHEET_URL, {
      method: 'POST', mode: 'no-cors',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ name, code, amount, timestamp: ts, status: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß' })
    }).catch(()=>{}).finally(()=>{ goLINE(); });
  } else {
    goLINE();
  }
}

function goLINE() {
  window.location.href = 'https://line.me/ti/p/Rpvv6sGPQY';
}

// ---- Toast notification ----
function showToast(msg, type) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className = 'toast show ' + type;
  setTimeout(() => t.className = 'toast', 3000);
}
</script>
</body>
</html>